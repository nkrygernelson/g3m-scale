2025-12-01 00:32:07,517 INFO    MainThread:94636 [wandb_setup.py:_flush():76] Configure stats pid to 94636
2025-12-01 00:32:07,517 INFO    MainThread:94636 [wandb_setup.py:_flush():76] Loading settings from /home/nico/.config/wandb/settings
2025-12-01 00:32:07,517 INFO    MainThread:94636 [wandb_setup.py:_flush():76] Loading settings from /home/nico/code/g3m-scale/wandb/settings
2025-12-01 00:32:07,518 INFO    MainThread:94636 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2025-12-01 00:32:07,518 INFO    MainThread:94636 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2025-12-01 00:32:07,518 INFO    MainThread:94636 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'src_gmmm/train.py', 'program': '/home/nico/code/g3m-scale/src_gmmm/train.py'}
2025-12-01 00:32:07,519 INFO    MainThread:94636 [wandb_init.py:_log_setup():506] Logging user logs to /home/nico/code/g3m-scale/logs/qm9/runs/2025-12-01_00-31-34/wandb/run-20251201_003207-3pisd2c8/logs/debug.log
2025-12-01 00:32:07,519 INFO    MainThread:94636 [wandb_init.py:_log_setup():507] Logging internal logs to /home/nico/code/g3m-scale/logs/qm9/runs/2025-12-01_00-31-34/wandb/run-20251201_003207-3pisd2c8/logs/debug-internal.log
2025-12-01 00:32:07,521 INFO    MainThread:94636 [wandb_init.py:init():546] calling init triggers
2025-12-01 00:32:07,521 INFO    MainThread:94636 [wandb_init.py:init():552] wandb.init called with sweep_config: {}
config: {}
2025-12-01 00:32:07,522 INFO    MainThread:94636 [wandb_init.py:init():602] starting backend
2025-12-01 00:32:07,523 INFO    MainThread:94636 [wandb_init.py:init():606] setting up manager
2025-12-01 00:32:07,530 INFO    MainThread:94636 [backend.py:_multiprocessing_setup():106] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-12-01 00:32:07,536 INFO    MainThread:94636 [wandb_init.py:init():613] backend started and connected
2025-12-01 00:32:07,540 INFO    MainThread:94636 [wandb_init.py:init():701] updated telemetry
2025-12-01 00:32:07,548 INFO    MainThread:94636 [wandb_init.py:init():741] communicating run to backend with 60.0 second timeout
2025-12-01 00:32:08,476 INFO    MainThread:94636 [wandb_run.py:_on_init():2133] communicating current version
2025-12-01 00:32:08,657 INFO    MainThread:94636 [wandb_run.py:_on_init():2142] got version response upgrade_message: "wandb version 0.23.0 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2025-12-01 00:32:08,657 INFO    MainThread:94636 [wandb_init.py:init():789] starting run threads in backend
2025-12-01 00:32:08,718 INFO    MainThread:94636 [wandb_run.py:_console_start():2114] atexit reg
2025-12-01 00:32:08,719 INFO    MainThread:94636 [wandb_run.py:_redirect():1969] redirect: 3
2025-12-01 00:32:08,719 INFO    MainThread:94636 [wandb_run.py:_redirect():2034] Wrapping output streams.
2025-12-01 00:32:08,719 INFO    MainThread:94636 [wandb_run.py:_redirect():2059] Redirects installed.
2025-12-01 00:32:08,720 INFO    MainThread:94636 [wandb_init.py:init():831] run started, returning control to user process
2025-12-01 00:32:08,809 INFO    MainThread:94636 [wandb_run.py:_config_callback():1251] config_cb None None {'lit_module/_target_': 'src_gmmm.lit.module.LitModule', 'lit_module/model/_target_': 'src_gmmm.model.diffusion.EquivariantDiffusion', 'lit_module/model/parameterization/_target_': 'src_gmmm.model.score.EquivariantParameterization', 'lit_module/model/parameterization/encoder/_target_': 'src_gmmm.nn.encoder.EquivEncoder', 'lit_module/model/parameterization/encoder/hidden_dim': 128, 'lit_module/model/parameterization/encoder/time_embedding/_target_': 'src_gmmm.nn.layers.FourierEmbedding', 'lit_module/model/parameterization/encoder/time_embedding/in_features': 1, 'lit_module/model/parameterization/encoder/time_embedding/out_features': 16, 'lit_module/model/parameterization/encoder/edge_embedding/_target_': 'src_gmmm.nn.layers.EdgeEmbedding', 'lit_module/model/parameterization/encoder/edge_embedding/num_rbf_features': 64, 'lit_module/model/parameterization/encoder/edge_embedding/max_distance': 12.0, 'lit_module/model/parameterization/encoder/num_layers': 5, 'lit_module/model/parameterization/encoder/smooth_h': False, 'lit_module/model/parameterization/encoder/h_input_dim': 100, 'lit_module/model/parameterization/readout/_target_': 'src_gmmm.nn.readout.DataPointReadout', 'lit_module/model/parameterization/readout/hidden_dim': 128, 'lit_module/model/parameterization/readout/pred_h': False, 'lit_module/model/parameterization/readout/pred_pos': True, 'lit_module/model/parameterization/readout/zero_cog': True, 'lit_module/model/parameterization/readout/parameterization': 'residual-pos', 'lit_module/model/diffusion_pos/_target_': 'src_gmmm.model.continuous.ContinuousDiffusion', 'lit_module/model/diffusion_pos/sde/_target_': 'src_gmmm.model.continuous.LinearLogSNRVPSDE', 'lit_module/model/diffusion_pos/parameterization': 'x0', 'lit_module/model/diffusion_pos/distribution/_target_': 'src_gmmm.model.distributions.DistributionGaussian', 'lit_module/model/diffusion_pos/distribution/dim': 3, 'lit_module/model/diffusion_pos/distribution/zero_cog': True, 'lit_module/model/diffusion_h': None, 'lit_module/metrics/_target_': 'src_gmmm.metrics.qm9.QM9Metrics', 'lit_module/metrics/atom_types_str': ['H', 'C', 'N', 'O', 'F'], 'lit_module/metrics/max_num_atoms': 29, 'lit_module/metrics/json_path': '/home/nico/code/g3m-scale/data/qm9/preprocessed/train_infos.json', 'lit_module/n_integration_steps': 250, 'lit_module/lr': 0.0002, 'lit_module/warm_up_steps': 100, 'lit_module/with_ema': True, 'lit_module/ema_start_step': 500, 'lit_module/ema_decay': 0.999, 'lit_module/antithetic_time_sampling': True, 'lit_module/loss_during_val': True, 'model/params/total': 2133002, 'model/params/trainable': 2133002, 'model/params/non_trainable': 0, 'datamodule/_target_': 'src_gmmm.data.datamodule.DataModule', 'datamodule/transform/_target_': 'torch_geometric.transforms.Compose', 'datamodule/transform/transforms': [{'_target_': 'src_gmmm.data.transforms.FullyConnected'}, {'_target_': 'src_gmmm.data.transforms.ZeroCoG', 'key': 'pos'}], 'datamodule/train_path': '/home/nico/code/g3m-scale/data/qm9/preprocessed/train.pt', 'datamodule/val_path': '/home/nico/code/g3m-scale/data/qm9/preprocessed/val.pt', 'datamodule/train_batch_size': 64, 'datamodule/val_batch_size': 256, 'datamodule/num_val_subset': 2048, 'datamodule/num_workers': 1, 'datamodule/pin_memory': True, 'datamodule/subset_seed': 42, 'trainer/_target_': 'pytorch_lightning.Trainer', 'trainer/accelerator': 'auto', 'trainer/devices': 1, 'trainer/gradient_clip_val': 1.0, 'trainer/gradient_clip_algorithm': 'norm', 'trainer/max_epochs': 1000, 'trainer/check_val_every_n_epoch': 2, 'trainer/num_sanity_val_steps': 0, 'callbacks/model_checkpoint/_target_': 'pytorch_lightning.callbacks.ModelCheckpoint', 'callbacks/model_checkpoint/dirpath': '/home/nico/code/g3m-scale/logs/qm9/runs/2025-12-01_00-31-34/checkpoints', 'callbacks/model_checkpoint/filename': '{epoch:03d}', 'callbacks/model_checkpoint/monitor': 'val/molecule_stable', 'callbacks/model_checkpoint/verbose': False, 'callbacks/model_checkpoint/save_last': True, 'callbacks/model_checkpoint/save_top_k': 3, 'callbacks/model_checkpoint/mode': 'max', 'callbacks/model_checkpoint/auto_insert_metric_name': True, 'callbacks/model_checkpoint/save_weights_only': False, 'callbacks/model_checkpoint/every_n_epochs': 2, 'callbacks/model_checkpoint/save_on_train_epoch_end': True, 'callbacks/log_sampled_atoms/_target_': 'src_gmmm.utils.callback.LogSampledAtomsCallback', 'callbacks/log_sampled_atoms/dirpath': '/home/nico/code/g3m-scale/logs/qm9/runs/2025-12-01_00-31-34/samples', 'callbacks/log_sampled_atoms/save_atoms': True, 'callbacks/log_sampled_atoms/num_log_wandb': 25, 'extras': None, 'task_name': None, 'tags': ['qm9'], 'ckpt_path': None, 'seed': 42}
2025-12-01 00:32:08,918 INFO    MainThread:94636 [wandb_run.py:_config_callback():1251] config_cb None None {'decoder': ['X', 'H', 'He', 'Li', 'Be', 'B', 'C', 'N', 'O', 'F', 'Ne', 'Na', 'Mg', 'Al', 'Si', 'P', 'S', 'Cl', 'Ar', 'K', 'Ca', 'Sc', 'Ti', 'V', 'Cr', 'Mn', 'Fe', 'Co', 'Ni', 'Cu', 'Zn', 'Ga', 'Ge', 'As', 'Se', 'Br', 'Kr', 'Rb', 'Sr', 'Y', 'Zr', 'Nb', 'Mo', 'Tc', 'Ru', 'Rh', 'Pd', 'Ag', 'Cd', 'In', 'Sn', 'Sb', 'Te', 'I', 'Xe', 'Cs', 'Ba', 'La', 'Ce', 'Pr', 'Nd', 'Pm', 'Sm', 'Eu', 'Gd', 'Tb', 'Dy', 'Ho', 'Er', 'Tm', 'Yb', 'Lu', 'Hf', 'Ta', 'W', 'Re', 'Os', 'Ir', 'Pt', 'Au', 'Hg', 'Tl', 'Pb', 'Bi', 'Po', 'At', 'Rn', 'Fr', 'Ra', 'Ac', 'Th', 'Pa', 'U', 'Np', 'Pu', 'Am', 'Cm', 'Bk', 'Cf', 'Es', 'Fm', 'Md', 'No', 'Lr', 'Rf', 'Db', 'Sg', 'Bh', 'Hs', 'Mt', 'Ds', 'Rg', 'Cn', 'Nh', 'Fl', 'Mc', 'Lv', 'Ts', 'Og'], 'n_integration_steps': 250, 'lr': 0.0002, 'warm_up_steps': 100, 'with_ema': True, 'ema_decay': 0.999, 'ema_start_step': 500, 'antithetic_time_sampling': True, 'loss_during_val': True, 'loss_weights': None}
